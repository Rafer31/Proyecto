<div class="rating-dialog">
  <h2 mat-dialog-title>Calificar Viaje</h2>

  <mat-dialog-content>
    <div class="trip-info">
      <p class="trip-destination">
        <mat-icon>place</mat-icon>
        <strong>{{ data.destino }}</strong>
      </p>
      <p class="trip-date">
        <mat-icon>event</mat-icon>
        {{ data.fecha }}
      </p>
    </div>

    <div class="rating-section">
      <p class="rating-label">¿Cómo calificarías este viaje?</p>

      <div class="stars-container">
        @for (star of stars; track star) {
          <button
            mat-icon-button
            class="star-button"
            [class.selected]="star <= selectedRating"
            [class.hovered]="star <= hoveredRating"
            [color]="getStarColor(star)"
            (click)="onStarClick(star)"
            (mouseenter)="onStarHover(star)"
            (mouseleave)="onStarLeave()"
          >
            <mat-icon>{{ getStarIcon(star) }}</mat-icon>
          </button>
        }
      </div>

      @if (selectedRating > 0) {
        <p class="rating-text">
          {{ selectedRating }} de 5 estrellas
        </p>
      }
    </div>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Comentario (opcional)</mat-label>
      <textarea
        matInput
        [(ngModel)]="comentario"
        rows="4"
        placeholder="Comparte tu experiencia sobre este viaje..."
        maxlength="500"
      ></textarea>
      <mat-hint align="end">{{ comentario.length }}/500</mat-hint>
    </mat-form-field>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">Cancelar</button>
    <button
      mat-raised-button
      color="primary"
      (click)="onSubmit()"
      [disabled]="!isValid"
    >
      Enviar Calificación
    </button>
  </mat-dialog-actions>
</div>
